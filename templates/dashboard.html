{% extends "base.html" %}
{% block title %}Dashboard â€” Ristorante AI{% endblock %}
{% block brand %}{{ current_user.restaurant.name }}{% endblock %}
{% block brand_sub %}<span class="brand-sub">â€” Dashboard ristorante</span>{% endblock %}

{% block body %}
<div class="container" id="view-reservations">
  <div class="grid kpis">
    <div class="card kpi-bar">
      <div class="kpi-title">Chiamate attive: <strong id="kpiActiveCalls">0/3</strong></div>
      <div class="status">
        <span class="led led-green"></span> Disponibile
      </div>
    </div>

    <div class="card kpi-small">
      <div class="kpi-sub">Prenotazioni oggi</div>
      <div class="kpi-value" id="kpiToday">0</div>
    </div>

    <div class="card kpi-small">
      <div class="kpi-sub">Incasso stimato</div>
      <div class="kpi-value" id="kpiRevenue">0 â‚¬</div>
    </div>
  </div>

  <div class="card filters">
    <div class="filter-row">
      <div class="date-input">
        <input class="input" id="flt-date" type="date" aria-label="Data">
        <span class="calendar-ico">ðŸ“…</span>
      </div>
      <input class="input grow" id="flt-q" type="text" placeholder="Cerca nome / telefono / orario">
      <div class="row-gap"></div>
      <button class="btn" id="btn-filter">Filtra</button>
      <button class="btn btn-ghost" id="btn-clear">Elimina filtri</button>
      <button class="btn btn-ghost" id="btn-today">Oggi</button>
      <button class="btn btn-primary right" id="btn-new">+ Nuova prenotazione</button>
    </div>
  </div>

  <div id="list"></div>
  <div class="card empty" id="list-empty" style="display:none">
    <div class="empty-title">Nessuna prenotazione trovata</div>
    <div class="muted">Prova a cambiare filtri o aggiungi una nuova prenotazione.</div>
    <button class="pill minus" aria-label="collapse">âˆ’</button>
  </div>
</div>

<!-- Prezzi & Coperti -->
<div class="container" id="view-pricing" style="display:none">
  <div class="card form-card">
    <h2>Prezzi & coperti</h2>
    <div class="grid-2" style="margin-top:12px">
      <label class="lbl">Prezzo medio prenotazione (â‚¬)
        <input class="input" id="avg_price" type="number" step="0.01" placeholder="25">
      </label>
      <label class="lbl">Coperto (â‚¬ a persona)
        <input class="input" id="cover" type="number" step="0.01" placeholder="0">
      </label>
      <label class="lbl">CapacitÃ  massima (opzionale)
        <input class="input" id="seats_cap" type="number" placeholder="">
      </label>
      <label class="lbl">Minimo persone (opzionale)
        <input class="input" id="min_people" type="number" placeholder="">
      </label>
    </div>
    <div style="margin-top:12px">
      <button class="btn btn-primary" id="btn-save-pricing">Salva</button>
    </div>
  </div>
</div>

<!-- Menu digitale -->
<div class="container" id="view-menu" style="display:none">
  <div class="card form-card">
    <h2>Menu digitale</h2>
    <label class="lbl">Link al menu (PDF/URL)
      <input class="input" id="menu_url" type="url" placeholder="https://...">
    </label>
    <label class="lbl">Descrizione breve
      <input class="input" id="menu_desc" type="text" placeholder="Sushi, piatti caldi, bevande">
    </label>
    <div style="margin-top:12px">
      <button class="btn btn-primary" id="btn-save-menu">Salva</button>
    </div>
  </div>
</div>

<!-- Orari settimanali -->
<div class="container" id="view-hours" style="display:none">
  <div class="card form-card">
    <h2>Orari settimanali</h2>
    <p class="muted">Inserisci finestre orarie per ogni giorno (es. <em>12:00-15:00, 19:00-22:30</em>)</p>
    <div class="grid">
      {% set days = ['LunedÃ¬','MartedÃ¬','MercoledÃ¬','GiovedÃ¬','VenerdÃ¬','Sabato','Domenica'] %}
      {% for d in days %}
      <label class="lbl">{{ d }}
        <input class="input hour-win" data-dow="{{ loop.index0 }}" type="text" placeholder="12:00-15:00, 19:00-22:30">
      </label>
      {% endfor %}
    </div>
    <div style="margin-top:12px">
      <button class="btn btn-primary" id="btn-save-hours">Salva orari</button>
    </div>
  </div>
</div>

<!-- Giorni speciali -->
<div class="container" id="view-special" style="display:none">
  <div class="card form-card">
    <h2>Giorni speciali / chiusure</h2>
    <div class="grid-2">
      <label class="lbl">Data (YYYY-MM-DD)
        <input class="input" id="sp_day" type="date">
      </label>
      <label class="lbl">Finestre orarie (vuoto se chiuso tutto il giorno)
        <input class="input" id="sp_windows" type="text" placeholder="12:00-15:00, 19:00-22:30">
      </label>
    </div>
    <label class="check" style="margin-top:8px">
      <input type="checkbox" id="sp_closed">
      <span>Chiuso tutto il giorno</span>
    </label>
    <div style="margin-top:12px">
      <button class="btn btn-primary" id="btn-save-special">Salva giorno speciale</button>
    </div>
  </div>
</div>

<!-- Statistiche & report -->
<div class="container" id="view-stats" style="display:none">
  <div class="card form-card">
    <h2>Statistiche & report</h2>
    <div class="grid-2" style="margin-top:12px">
      <label class="lbl">Filtra per data (opzionale)
        <input class="input" id="st_date" type="date">
      </label>
    </div>
    <div style="margin-top:12px">
      <button class="btn" id="btn-load-stats">Aggiorna</button>
    </div>

    <div class="grid" style="margin-top:16px">
      <div class="card kpi-small">
        <div class="kpi-sub">Prenotazioni</div>
        <div class="kpi-value" id="st_total">0</div>
      </div>
      <div class="card kpi-small">
        <div class="kpi-sub">Persone per prenotazione (media)</div>
        <div class="kpi-value" id="st_avg_people">0</div>
      </div>
      <div class="card kpi-small">
        <div class="kpi-sub">Prezzo medio (impostazioni)</div>
        <div class="kpi-value" id="st_avg_price">0 â‚¬</div>
      </div>
      <div class="card kpi-small">
        <div class="kpi-sub">Incasso stimato</div>
        <div class="kpi-value" id="st_revenue">0 â‚¬</div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
