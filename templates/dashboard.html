{% extends "base.html" %}
{% block title %}Dashboard â€” Ristorante AI{% endblock %}
{% block brand %}{{ current_user.restaurant.name }}{% endblock %}
{% block brand_sub %}<span class="brand-sub">â€” Dashboard ristorante</span>{% endblock %}

{% block body %}
<div class="container">
  <!-- KPI -->
  <div class="grid kpis">
    <div class="card kpi-bar">
      <div class="kpi-title">Chiamate attive: <strong id="kpiActiveCalls">0/3</strong></div>
      <div class="status"><span class="led led-green"></span> Disponibile</div>
    </div>

    <div class="card kpi-small">
      <div class="kpi-sub">Prenotazioni oggi</div>
      <div class="kpi-value" id="kpiToday">0</div>
    </div>

    <div class="card kpi-small">
      <div class="kpi-sub">Incasso stimato</div>
      <div class="kpi-value" id="kpiRevenue">0 â‚¬</div>
    </div>
  </div>

  <!-- Filtri -->
  <div class="card filters">
    <div class="filter-row">
      <div class="date-input">
        <input id="flt-date" class="input" type="text" placeholder="gg/mm/aaaa" aria-label="Data">
        <span class="calendar-ico">ðŸ“…</span>
      </div>
      <input id="flt-q" class="input grow" type="text" placeholder="Cerca nome / telefono / orario">
      <div class="row-gap"></div>
      <button id="btn-filter" class="btn">Filtra</button>
      <button id="btn-clear" class="btn btn-ghost">Elimina filtri</button>
      <!-- RIMOSSO Storico 30gg -->
      <button id="btn-today" class="btn btn-ghost">Oggi</button>
      <button id="btn-new" class="btn btn-primary right">+ Nuova prenotazione</button>
    </div>
  </div>

  <!-- Lista/placeholder -->
  <div id="list-empty" class="card empty">
    <div class="empty-title">Nessuna prenotazione trovata</div>
    <div class="muted">Prova a cambiare filtri o aggiungi una nuova prenotazione.</div>
    <button class="pill minus" aria-label="collapse">âˆ’</button>
  </div>
  <div id="list"></div>
</div>

<!-- MODALE: Orari settimanali -->
<div id="dlgHours" class="modal">
  <div class="modal-card">
    <div class="modal-head">
      <div class="modal-title">Orari settimanali</div>
      <button class="modal-close" data-close="dlgHours">Ã—</button>
    </div>
    <div class="modal-body">
      <div class="muted" style="margin-bottom:10px;">
        Formato: <strong>HH:MM-HH:MM</strong> (es. <code>12:00-15:00, 19:00-22:30</code>). Giorno vuoto = <strong>CHIUSO</strong>.
      </div>
      <div class="grid-2">
        {% set days = ['LunedÃ¬','MartedÃ¬','MercoledÃ¬','GiovedÃ¬','VenerdÃ¬','Sabato','Domenica'] %}
        {% for d in days %}
          <label class="lbl">
            {{ d }}
            <input class="input wh" data-dow="{{ loop.index0 }}" type="text" placeholder="12:00-15:00, 19:00-23:00">
          </label>
        {% endfor %}
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn btn-ghost" data-close="dlgHours">Chiudi</button>
      <button id="btn-save-hours" class="btn btn-primary">Salva</button>
    </div>
  </div>
</div>

<!-- MODALE: Giorni speciali -->
<div id="dlgSpecial" class="modal">
  <div class="modal-card">
    <div class="modal-head">
      <div class="modal-title">Giorni speciali</div>
      <button class="modal-close" data-close="dlgSpecial">Ã—</button>
    </div>
    <div class="modal-body">
      <label class="lbl">Data
        <input id="sp-day" class="input" type="text" placeholder="YYYY-MM-DD">
      </label>
      <label class="check" style="margin:8px 0 12px">
        <input id="sp-closed" type="checkbox">
        <span>Chiudi tutto il giorno</span>
      </label>
      <label class="lbl">Finestre (se aperto)
        <input id="sp-windows" class="input" type="text" placeholder="18:00-23:00, 12:00-15:00">
      </label>
      <div class="muted" style="margin-top:6px">Esempio: <code>18:00-23:00, 12:00-15:00</code></div>
    </div>
    <div class="modal-foot">
      <button class="btn btn-ghost" data-close="dlgSpecial">Chiudi</button>
      <button id="btn-del-special" class="btn">Elimina</button>
      <button id="btn-save-special" class="btn btn-primary">Aggiungi / Aggiorna</button>
    </div>
  </div>
</div>
{% endblock %}
