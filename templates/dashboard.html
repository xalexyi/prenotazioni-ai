{% extends "base.html" %}
{% block title %}Dashboard — Ristorante AI{% endblock %}
{% block body %}
<header class="topbar">
  <button id="btn-menu" aria-label="Apri menu" class="icon">☰</button>
  <div class="brand-dot"></div>
  <div class="brand">Haru Asian Fusion Restaurant <span class="muted">— Dashboard ristorante</span></div>
  <div class="spacer"></div>
  <button id="btn-theme" class="toggle"></button>
  <a class="btn btn-danger" href="{{ url_for('logout') }}">Logout</a>
</header>

<aside id="drawer" hidden>
  <div class="drawer-head">
    <div class="brand-dot"></div>
    <div class="title">Haru Asian Fusion Restaurant</div>
    <button id="drawer-close" class="icon">✕</button>
  </div>
  <div class="drawer-sec">PRENOTAZIONI</div>
  <a href="#" data-nav="dash" class="drawer-link active">Dashboard</a>
  <div class="drawer-sec">IMPOSTAZIONI RISTORANTE</div>
  <a href="#" data-nav="hours" class="drawer-link">Orari di apertura</a>
  <a href="#" data-nav="special" class="drawer-link">Giorni speciali / chiusure</a>
  <a href="#" data-nav="prices" class="drawer-link">Prezzi & coperti</a>
  <a href="#" data-nav="menu" class="drawer-link">Menu digitale</a>
  <div class="drawer-sec">STRUMENTI</div>
  <a href="#" data-nav="stats" class="drawer-link">Statistiche & report</a>
</aside>

<main class="container">

  <!-- KPI -->
  <section class="kpis" id="kpis">
    <div class="kpi"><div class="k">Chiamate attive</div><div class="v">0 / 3</div></div>
    <div class="kpi"><div class="k">Prenotazioni oggi</div><div class="v" id="kpi-today">0</div></div>
    <div class="kpi"><div class="k">Incasso stimato</div><div class="v" id="kpi-revenue">0 €</div></div>
  </section>

  <!-- Filtri -->
  <section class="filters">
    <input id="f-date" placeholder="gg/mm/aaaa" value="{{ (now or none) }}">
    <input id="f-q" placeholder="Nome / telefono / orario">
    <button id="btn-filter" class="btn">Filtra</button>
    <button id="btn-clear" class="btn btn-outline">Elimina filtri</button>
    <button id="btn-today" class="btn">Oggi</button>
    <button id="btn-new" class="btn btn-primary">+ Nuova prenotazione</button>
  </section>

  <!-- Tabella -->
  <section class="card">
    <table class="table" id="tbl-res">
      <thead>
        <tr>
          <th>Data & Ora</th>
          <th>Cliente</th>
          <th>Telefono</th>
          <th>Pers.</th>
          <th>Stato</th>
          <th>Note</th>
          <th>Azioni</th>
        </tr>
      </thead>
      <tbody id="res-body"><tr><td colspan="7" class="muted">Nessuna prenotazione trovata.</td></tr></tbody>
    </table>
  </section>

  <!-- Sezioni impostazioni (placeholders, gestite via JS/ API già presenti) -->
  <section class="card hidden" id="sec-hours">
    <h3>Orari settimanali</h3>
    <div class="muted">Inserisci finestre tipo 12:00-15:00, 19:00-23:00. Lascia vuoto per <i>chiuso</i>.</div>
    <div id="hours-grid" class="grid-2"></div>
    <button id="btn-save-hours" class="btn btn-primary mt-2">Salva orari</button>
  </section>

  <section class="card hidden" id="sec-special">
    <h3>Giorni speciali / chiusure</h3>
    <div class="row">
      <input id="sp-date" placeholder="Data (YYYY-MM-DD)">
      <select id="sp-closed">
        <option value="1">Sì, chiuso</option>
        <option value="0" selected>No, finestre</option>
      </select>
    </div>
    <input id="sp-windows" placeholder="Finestre orarie es: 12:00-15:00, 19:00-22:30">
    <button id="btn-save-special" class="btn btn-primary mt-2">Salva giorno</button>
    <div id="toast" class="toast" hidden>Giorno speciale salvato ✔</div>
  </section>

  <section class="card hidden" id="sec-prices">
    <h3>Prezzi & coperti</h3>
    <div class="grid-4">
      <input id="price-avg" placeholder="Prezzo medio (€)">
      <input id="cover-fee" placeholder="Coperto (€)">
      <input id="cap-max" placeholder="Capienza massima">
      <input id="min-people" placeholder="Persone minime">
    </div>
    <button id="btn-save-prices" class="btn btn-primary mt-2">Salva</button>
  </section>

  <section class="card hidden" id="sec-menu">
    <h3>Menu digitale</h3>
    <input id="menu-url" placeholder="https://...">
    <textarea id="menu-desc" placeholder="Note sul menu, aggiornamenti..."></textarea>
    <button id="btn-save-menu" class="btn btn-primary mt-2">Salva</button>
  </section>

  <section class="card hidden" id="sec-stats">
    <h3>Statistiche & report</h3>
    <div class="grid-3">
      <div class="kpi"><div class="k">Prenotazioni</div><div class="v" id="st-res">0</div></div>
      <div class="kpi"><div class="k">Persone / pren. (media)</div><div class="v" id="st-avg">0</div></div>
      <div class="kpi"><div class="k">Prezzo medio (impostazioni)</div><div class="v" id="st-price">0 €</div></div>
    </div>
  </section>

</main>

<!-- Modal nuova prenotazione -->
<div id="modal" class="modal-backdrop" hidden>
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title">Nuova prenotazione</div>
      <button id="modal-x" class="icon">✕</button>
    </div>
    <div class="modal-body grid-2">
      <div>
        <label>Data</label><input id="m-date" placeholder="YYYY-MM-DD">
      </div>
      <div>
        <label>Ora</label><input id="m-time" placeholder="HH:MM">
      </div>
      <div>
        <label>Nome</label><input id="m-name">
      </div>
      <div>
        <label>Telefono</label><input id="m-phone">
      </div>
      <div>
        <label>Persone</label><input id="m-people" value="2">
      </div>
      <div>
        <label>Stato</label>
        <select id="m-status">
          <option>PENDING</option><option>CONFERMATA</option><option>RIFIUTATA</option>
        </select>
      </div>
      <div class="col-span-2">
        <label>Note</label><textarea id="m-note" placeholder="Allergie, richieste..."></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button id="modal-cancel" class="btn btn-outline">Annulla</button>
      <button id="modal-save" class="btn btn-primary">Salva prenotazione</button>
    </div>
  </div>
</div>
{% endblock %}
