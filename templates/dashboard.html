{% extends "base.html" %}
{% block title %}{{ restaurant.name }} — Dashboard ristorante{% endblock %}

{% block content %}

<!-- HEADER STICKY TOOLS -->
<section class="sticky-tools">
  <div class="left">
    <h2 class="panel-title">
      Prenotazioni
      <span class="live-clock" id="liveClock">--:--</span>
    </h2>
  </div>
  <div class="right tools">
    <div class="search-box">
      <input id="searchBox" class="input" type="text" placeholder="Cerca nome / telefono / orario…" />
    </div>
    <input id="dateFilter" type="date" class="input input--date" />
    <button id="btnToday" class="btn btn-secondary">Oggi</button>
    <button id="btnLast30" class="btn btn-secondary">Ultimi 30gg</button>
    <button id="btnRefresh" class="btn btn-secondary">Aggiorna</button>
    <button id="btnCreateReservation" class="btn btn-primary">Crea prenotazione</button>
  </div>
</section>

<!-- CARDS SUMMARY -->
<section class="cards">
  <article class="card">
    <div class="card__title">Prenotazioni oggi</div>
    <div class="card__value" id="sumBookings">0</div>
  </article>
  <article class="card">
    <div class="card__title">Persone totali</div>
    <div class="card__value" id="sumPeople">0</div>
  </article>
  <article class="card">
    <div class="card__title">% Occupazione stimata</div>
    <div class="card__value" id="sumOcc">0%</div>
  </article>
  <article class="card card--ai">
    <div class="card__title">Riepilogo AI</div>
    <div class="card__ai" id="aiSummary">Analisi in corso…</div>
  </article>
</section>

<!-- TABELLA -->
<section class="panel">
  <header class="panel__header">
    <div class="tabs">
      <button class="tab is-active" data-range="today">Oggi</button>
      <button class="tab" data-range="last30">Ultimi 30gg</button>
      <button class="tab" data-range="all">Tutte</button>
    </div>
    <div class="panel__tools">
      <button id="btnExport" class="btn btn-secondary">Esporta CSV</button>
    </div>
  </header>

  <div class="panel__body">
    <div id="reservationsTable" class="table">
      <!-- riempito da JS -->
    </div>
  </div>
</section>

<!-- ANALISI ORARI -->
<section class="panel">
  <header class="panel__header">
    <h3 class="panel-title">Suggerimenti AI sugli orari</h3>
    <button id="btnAnalyzeHours" class="btn btn-secondary">Analizza orari</button>
  </header>
  <div class="panel__body">
    <div id="hoursInsights" class="ai-insights muted">Nessuna analisi ancora.</div>
  </div>
</section>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
