{% extends "base.html" %}
{% block title %}Dashboard — Ristorante AI{% endblock %}
{% block brand %}{{ current_user.restaurant.name }}{% endblock %}
{% block brand_sub %}<span class="brand-sub">— Dashboard ristorante</span>{% endblock %}

{% block body %}

<!-- SECTION: DASHBOARD PRINCIPALE -->
<section id="section-dashboard" class="dash-section" data-section active>
  <div class="kpis">
    <div class="kpi">
      <div class="k">Chiamate attive</div>
      <div class="v"><span id="kpiActive">0</span> / 3</div>
    </div>
    <div class="kpi">
      <div class="k">Prenotazioni oggi</div>
      <div class="v" id="kpiToday">0</div>
    </div>
    <div class="kpi">
      <div class="k">Incasso stimato</div>
      <div class="v" id="kpiRevenue">0 €</div>
    </div>
  </div>

  <div class="card pad">
    <div class="form-row">
      <label class="w-100">Data
        <input class="input" type="date" id="flt-date">
      </label>
      <label class="w-100">Cerca
        <input class="input" type="text" id="flt-q" placeholder="Nome / telefono / orario">
      </label>
      <div class="actions" style="margin-left:auto">
        <button id="btn-filter" class="btn">Filtra</button>
        <button id="btn-clear" class="btn btn-outline">Elimina filtri</button>
        <button id="btn-today" class="btn btn-outline">Oggi</button>
        <button id="btn-new" class="btn btn-primary">+ Nuova prenotazione</button>
      </div>
    </div>
  </div>

  <div class="card" style="margin-top:14px;">
    <table class="table">
      <thead>
      <tr>
        <th class="col-time">Data & Ora</th>
        <th>Cliente</th>
        <th>Telefono</th>
        <th class="col-people">Pers.</th>
        <th class="col-state">Stato</th>
        <th>Note</th>
        <th class="col-actions">Azioni</th>
      </tr>
      </thead>
      <tbody id="res-tbody">
      <!-- righe iniettate da JS -->
      </tbody>
    </table>

    <div id="list-empty" class="pad text-muted" hidden>Nessuna prenotazione trovata.</div>
  </div>
</section>

<!-- SECTION: ORARI -->
<section id="section-hours" class="dash-section" data-section hidden>
  <div class="card pad">
    <div class="title">Orari settimanali</div>
    <p class="text-muted">Inserisci finestre tipo <code>12:00-15:00, 19:00-22:30</code>. Lascia vuoto per <i>chiuso</i>.</p>
    <div id="hours-grid" class="grid hours-grid">
      <!-- compilato da JS -->
    </div>
    <div class="actions mt-2" style="justify-content:flex-end">
      <button id="btn-save-hours" class="btn btn-primary">Salva orari</button>
    </div>
  </div>
</section>

<!-- SECTION: GIORNI SPECIALI -->
<section id="section-special" class="dash-section" data-section hidden>
  <div class="card pad">
    <div class="title">Giorni speciali / chiusure</div>
    <div class="form-row">
      <label class="w-100">Data
        <input id="sp-day" type="date" class="input">
      </label>
      <label class="w-100">Chiuso tutto il giorno?
        <select id="sp-closed" class="input">
          <option value="true">Sì, chiuso</option>
          <option value="false">No, definisci finestre</option>
        </select>
      </label>
    </div>
    <label class="mt-2">Finestre (se non chiuso)
      <input id="sp-windows" type="text" class="input" placeholder="12:00-15:00, 19:00-22:30">
    </label>
    <div class="actions mt-2" style="justify-content:flex-end">
      <button id="btn-save-special" class="btn btn-primary">Salva giorno</button>
    </div>
  </div>
</section>

<!-- SECTION: PREZZI & COPERTI -->
<section id="section-pricing" class="dash-section" data-section hidden>
  <div class="card pad">
    <div class="title">Prezzi & Coperti</div>
    <div class="form-row">
      <label class="w-100">Prezzo medio (€)
        <input id="pr-avg" type="number" step="0.01" class="input" placeholder="25.00">
      </label>
      <label class="w-100">Coperto (€)
        <input id="pr-cover" type="number" step="0.01" class="input" placeholder="0.00">
      </label>
      <label class="w-100">Capienza massima
        <input id="pr-seats" type="number" class="input" placeholder="60">
      </label>
      <label class="w-100">Persone minime
        <input id="pr-min" type="number" class="input" placeholder="1">
      </label>
    </div>
    <div class="actions mt-2" style="justify-content:flex-end">
      <button id="btn-save-pricing" class="btn btn-primary">Salva</button>
    </div>
  </div>
</section>

<!-- SECTION: MENU DIGITALE -->
<section id="section-menu" class="dash-section" data-section hidden>
  <div class="card pad">
    <div class="title">Menu digitale</div>
    <label>URL menu (PDF/WEB)
      <input id="mn-url" type="url" class="input" placeholder="https://...">
    </label>
    <label class="mt-2">Descrizione (opzionale)
      <textarea id="mn-desc" class="input" rows="3" placeholder="Note sul menu, aggiornamenti..."></textarea>
    </label>
    <div class="actions mt-2" style="justify-content:flex-end">
      <button id="btn-save-menu" class="btn btn-primary">Salva</button>
    </div>
  </div>
</section>

<!-- SECTION: STATISTICHE -->
<section id="section-stats" class="dash-section" data-section hidden>
  <div class="card pad">
    <div class="title">Statistiche & report</div>
    <div class="form-row">
      <label>Data
        <input id="st-date" type="date" class="input">
      </label>
      <div class="actions" style="align-self:flex-end">
        <button id="btn-load-stats" class="btn">Aggiorna</button>
      </div>
    </div>
    <div class="grid kpis mt-2" id="stats-box">
      <div class="kpi"><div class="k">Totale prenotazioni</div><div class="v" id="st-total">0</div></div>
      <div class="kpi"><div class="k">Persone medie</div><div class="v" id="st-avgp">0</div></div>
      <div class="kpi"><div class="k">Incasso stimato</div><div class="v" id="st-rev">0 €</div></div>
    </div>
  </div>
</section>

{% endblock %}
